Seemed pretty interesting to investigate thanks to a question by someone, this is just a bad dsl in R to make things run on the gpu as well cpu. it is ugly but it works
